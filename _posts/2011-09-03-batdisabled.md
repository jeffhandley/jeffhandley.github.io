---
layout: post
title: "Business Application Project Login / Registration Disables Everything"
date: 2011-09-03 22:42:56 -0700
comments: true
category: Archive
tags: []
redirect_from: ["http://jeffhandley.github.io/archive/2011/09/03/BATDisabled.aspx", "http://jeffhandley.github.io/archive/2011/09/03/batdisabled.aspx"]
author: 0
---
<!-- more -->
<p>There is a known issue with WCF RIA Services V1.0 SP2 RC’s Business Application project template.  The issue only surfaces in Silverlight 5, and there’s an easy way to fix it.  We determined the root cause of this issue after it was too late to fix it in time for the RC release, but the correction is in place for the RTW (final) release of SP2.</p>  <p>This bug surfaces after you create a new project after installing RIA Services SP2, using the Business Application project template, and then an end user registers or logs in.  After completing the registration/login process, the entire application is disabled.  You can see the Home, About, and logout buttons are disabled, and nothing is clickable.</p>  <p><a href="http://jeffhandley.com/images/jeffhandley_com/Windows-Live-Writer/84403f50f45e_D26D/image_2.png" rel="lightbox"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jeffhandley.com/images/jeffhandley_com/Windows-Live-Writer/84403f50f45e_D26D/image_thumb.png" width="215" height="87" /></a></p>  <p>If you change the project to target Silverlight 4, the problem goes away.  This made us think the problem was in the Silverlight runtime or SDK, but after the Silverlight team investigated it, the root cause ended up being in the project template within the code we put in place to help you get started.</p>  <p>It boils down to the LoginRegistrationWindow.xaml.cs file that is included in the template under the Views\Login folder in the Silverlight project.  Within that file, the OnOpened method from ChildWindow is overridden:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:47557551-dd3f-4dd6-84c2-a32a63571edc" class="wlWriterEditableSmartContent"> <div style="border: #000080 1px solid; color: #000; font-family: 'Courier New', Courier, Monospace; font-size: 10pt"> <div style="background: #000080; color: #fff; font-family: Verdana, Tahoma, Arial, sans-serif; font-weight: bold; padding: 2px 5px">Code Snippet</div> <div style="background: #ddd; max-height: 300px; overflow: auto"> <ol style="background: #ffffff; margin: 0 0 0 2em; padding: 0 0 0 5px;"> <li><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span></li> <li style="background: #f3f3f3"><span style="color:#808080">///</span><span style="color:#008000"> Ensures the visual state and focus are correct when the window is opened.</span></li> <li><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span></li> <li style="background: #f3f3f3"><span style="color:#0000ff">protected</span> <span style="color:#0000ff">override</span> <span style="color:#0000ff">void</span> OnOpened()</li> <li>{</li> <li style="background: #f3f3f3">    <span style="color:#0000ff">this</span>.NavigateToLogin();</li> <li>}</li> </ol> </div> </div> </div>  <p> </p>  <p>The problem is that in this override, the code does not call base.OnOpened().  When targeting the Silverlight 4 SDK, this just happens to work out okay and the screen gets re-enabled, but when targeting the Silverlight 5 SDK, a change to ChildWindow makes this misuse lead to a disabled screen.  By simply adding base.OnOpened before this.NavigateToLogin(), the problem goes away.</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:96285032-e2b4-4401-a8dc-007bd355571c" class="wlWriterEditableSmartContent"> <div style="border: #000080 1px solid; color: #000; font-family: 'Courier New', Courier, Monospace; font-size: 10pt"> <div style="background: #000080; color: #fff; font-family: Verdana, Tahoma, Arial, sans-serif; font-weight: bold; padding: 2px 5px">Code Snippet</div> <div style="background: #ddd; max-height: 300px; overflow: auto"> <ol style="background: #ffffff; margin: 0 0 0 2em; padding: 0 0 0 5px;"> <li><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span></li> <li style="background: #f3f3f3"><span style="color:#808080">///</span><span style="color:#008000"> Ensures the visual state and focus are correct when the window is opened.</span></li> <li><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span></li> <li style="background: #f3f3f3"><span style="color:#0000ff">protected</span> <span style="color:#0000ff">override</span> <span style="color:#0000ff">void</span> OnOpened()</li> <li>{</li> <li style="background: #f3f3f3">    <span style="color:#0000ff">base</span>.OnOpened();</li> <li>    <span style="color:#0000ff">this</span>.NavigateToLogin();</li> <li style="background: #f3f3f3">}</li> </ol> </div> </div> </div>  <p> </p>  <p>With that fix in place, you can register/log in and the app will return to normal.  This same problem exists for the VB version of the template. You would need to a call to MyBase.OnOpened() to fix the problem.  Here’s what the Home, About, and logout links will look after applying the fix.</p>  <p><a href="http://jeffhandley.com/images/jeffhandley_com/Windows-Live-Writer/84403f50f45e_D26D/image_4.png" rel="lightbox"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jeffhandley.com/images/jeffhandley_com/Windows-Live-Writer/84403f50f45e_D26D/image_thumb_1.png" width="215" height="87" /></a></p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:cb41d64d-e464-4752-8d71-230a82afd98f" class="wlWriterEditableSmartContent">Technorati Tags: <a href="http://technorati.com/tags/RIAServices" rel="tag">RIAServices</a>,<a href="http://technorati.com/tags/Silverlight" rel="tag">Silverlight</a></div>

